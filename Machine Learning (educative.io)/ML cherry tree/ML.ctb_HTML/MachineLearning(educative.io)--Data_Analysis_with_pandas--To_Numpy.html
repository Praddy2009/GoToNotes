<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>To Numpy</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">To Numpy</h1><br/><br /><h3>Chapter Goals:</h3><br />  • Learn how to convert a DataFrame to a NumPy matrix<br />  • Write code to modify an MLB dataset and convert it to a NumPy matrix<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><strong>Machine Learning</strong><br /><br />The DataFrame object is great for storing a dataset and performing data analysis in Python. However, most of the machine learning frameworks (eg TensorFlow), work directly with NumPy data. Furthermore, the NumPy data used as input to machine learning models must solely contain quantitative values.<br /><br />Therefore, to use a DataFrame's data with a machine learning model, we need to convert the DataFrame to a NumPy matrix of quantitative data. So even the categorial features of a DataFrame,such as gender and birthplace, must be converted to quantitative values.<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><strong>Indicator Features</strong><br /><br />When converting a DataFrame to a Numpy matrix of quantitative data, we need to find a way to modify the categorial features in the DataFrame.<br /><br />The easiest way to do this is to convert each categorial feature into a set of indicator features for each of its categories. The indicator feature for a specific category represents whether or not a given sample belongs to that category.<br /><br /><img src="images/10-1.png" alt="images/10-1.png" />  <img src="images/10-2.png" alt="images/10-2.png" />   <img src="images/10-3.png" alt="images/10-3.png" /><br /><br />In the code above, the DataFrame <code>df</code> has a single categorical feature called <code>Color</code>. The corresponding indicator features for <code>Color</code> are shown in <code>indicator_df</code>.<br /><br />Note that an indicator feature contains <code>1</code> when the row has that particular category, and <code>0</code> if the row does not.<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><strong>Converting to indicators</strong><br /><br />In pandas, we convert each categorical feature of a DataFrame to indicator features with the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html">get_dummies</a> function. The function takes in a DataFrame as its required argument, and returns the DataFrame with each of its categorical features converted to indicator features.<br /><br /><img src="images/10-4.png" alt="images/10-4.png" />     <img src="images/10-5.png" alt="images/10-5.png" /><br /><br />Note that the indicator features have the original categorical feature's label as a prefix. This makes it easy to see where each indicator feature originally came from.<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><strong>Converting to NumPy</strong><br /><br />After converting all the categorical features to indicator features, the DataFrame should have all quantitative data. We can then convert to a NumPy matrix using the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.values.html#pandas.DataFrame.values">values</a> function.<br /><br /><img src="images/10-6.png" alt="images/10-6.png" />   <img src="images/10-7.png" alt="images/10-7.png" /><img src="images/10-8.png" alt="images/10-8.png" /><br /><br />The rows and columns of the output matrix correspond to the rows and columns of the same position in the DataFrame. In the code above, the first column of the NumPy matrix represents <code>HR</code>, the second column represents <code>teamID_BOS</code>, and the third column represents <code>teamID_PIT</code>.<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><img src="images/10-9.png" alt="images/10-9.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><img src="images/10-10.png" alt="images/10-10.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><img src="images/10-11.png" alt="images/10-11.png" /><br /><br /></div></body></html>