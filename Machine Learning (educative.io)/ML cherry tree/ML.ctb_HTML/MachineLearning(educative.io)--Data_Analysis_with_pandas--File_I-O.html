<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>File I/O</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">File I/O</h1><br/>Chapter goals<br />  • Learn how to handle file input/output using pandas<br />  • Write code for processing data files<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><br /><h1>Reading data<br /></h1>One of the most important features in pandas is the ability to read from data files. pandas accepts a variety of file formats, ranging from CSV and Excel spreadsheets to SQL and even HTML. A full list of the available file formats for pandas can be found <a href="http://pandas.pydata.org/pandas-docs/stable/io.html">here</a><br /><br />In this chapter we'll focus on three of the most common file types: <a href="https://en.wikipedia.org/wiki/Comma-separated_values">CSV</a>, <a href="https://en.wikipedia.org/wiki/Microsoft_Excel">XLSX (Microsoft Excel)</a>, and JSON. For reading data from a file, we use either the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">read_csv</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html">read_excel</a>, or <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_json.html">read_json</a> function, depending on the file type.<br /><br />Each of the file reading functions takes in a file path as the only required argument. Each function has numerous keyword arguments, so we won't get into most of them.However, we'll still discuss a couple of the more commonly used keyword arguments.<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h1>CSV</h1><br /><br />A CSV file is pretty straightforward; it's just comma-separated column names and values. When we don't use any keyword arguments, <code>pd.read_csv</code> returns a DataFrame with integer indexes as row labels, and each comma-separated column name as the column labels.<br /><br />However, when we set the <code>index_col</code> keyword argument, we specify which column we want to use as the row labels. In our example, we used the first and second column as row labels.<br /><br /><img src="images/5-1.png" alt="images/5-1.png" />      <img src="images/5-2.png" alt="images/5-2.png" />    <br /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br />An excel spreadsheet is similar to a CSV in its usage of rows and columns. However,the file path for <code>pd.read_excel</code> normally specifies an Excel workbook, which can contain multiple spreadsheets.<br /><br />When we don't use any keyword arguments, the returned DataFrame from <code>pd.read_excel</code> contains the first sheet of the Excel workbook. However, when we set the <code>sheet_name</code> keyword argument, we can obtain a specific spreadsheet by passing in its integer index or name.<br /><br />Furthermore, we obtain an ordered dictionary of spreadsheets by passing in a list of integers or sheet names.Setting <code>sheet_name=None</code> returns all the sheets in an ordered dictionary.<br /><br />Like <code>pd.read_csv</code>, we can also specify the <code>index_col</code> argument in <code>pd.read_excel</code>.<br /><br /><img src="images/5-3.png" alt="images/5-3.png" />        <img src="images/5-4.png" alt="images/5-4.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h1>JSON</h1><br /><br />JSON data is pretty similar to python dictionary. In fact, you can use the Json module (part of the Python standard library) to convert between dictionaries and JSON data. The file path for <code>pd.read_json</code> specifies a file containing JSON data.<br /><br />When we don't use any keyword arguments, <code>pd.read_json</code>  treats each outer key of the JSON data as a column label and each inner  key as a row label. In the code example below, you can see <code>df1</code> treats the player's names as column labels.<br /><br />However, when we set <code>orient='index'</code>, the outer keys are treated as row labels and the inner keys are treated as column labels.<br /><br /><img src="images/5-5.png" alt="images/5-5.png" />           <img src="images/5-6.png" alt="images/5-6.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h1>Wriring to files</h1><br /><br />We can also use pandas to  write data to a file. Focusing again on CSV, Excel, and JSON, the  functions we use to write to files are <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_csv.html">to_csv</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_excel.html">to_excel</a>, and <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_json.html">to_json</a>.<br /><br />Similar to the file reading functions, each of the writing functions has dozens of keyword arguments. Therefore, we'll only go over a few of the commonly used ones.<br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><h1>CSV</h1><br /><br />Note that when we don't use any keyword arguments, <code>to_csv</code> will write the row labels as the first column in the CSV file. This is fine if the row labels are meaningful, but if they are just integers we don't really want them in the CSV file. In that case, we set <code>index=False</code>, to specify that we don't write the row labels into the CSV file.<br /><br /><img src="images/5-7.png" alt="images/5-7.png" />     <img src="images/5-8.png" alt="images/5-8.png" /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h1>Excel</h1><br /><br />The basic <code>to_excel</code> function will only write a single DataFrame to a spreadsheet. However, if we want to write multiple spreadsheets in an Excel workbook, we first load the Excel file into a <code>pd.ExcelWriter</code> then use the ExcelWriter as the first argument to <code>to_excel</code>.<br /><br />When we don't specify the <code>sheet_name</code> keyword argument, the Excel spreadsheet we write to is named <code>'Sheet1'</code>. We can pass in custom names into <code>sheet_name</code> to avoid constantly writing to <code>'Sheet1'</code>.<br /><br /><img src="images/5-9.png" alt="images/5-9.png" />         <img src="images/5-10.png" alt="images/5-10.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><h1>JSON</h1><br /><br />The <code>to_json</code> function also uses the <code>orient</code> keyword argument that was part of <code>pd.read_json</code>. Like in <code>pd.read_json</code>, setting <code>orient='index'</code> will set the outer keys of the JSON data to the row labels and the inner keys to the column labels.<br /><br />The code below shows how to use <code>to_json</code>.<br /><br /><img src="images/5-11.png" alt="images/5-11.png" />        <img src="images/5-12.png" alt="images/5-12.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><img src="images/5-13.png" alt="images/5-13.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><img src="images/5-14.png" alt="images/5-14.png" /><br /><br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br /><br /><img src="images/5-15.png" alt="images/5-15.png" /><br /><br /><br /></div></body></html>